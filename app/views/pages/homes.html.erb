<div id="wrapper">
	
	<div id="sidebar">
		<div id="widget" class="sticky">

			<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrkinOiy-78rJq1uLTy-jkAW1aHbfFYCo"></script>
	    <script>
	      function initialize() {
	        var mapCanvas = document.getElementById('widget');
	        var mapOptions = {
	        	<% if @arrRooms.length > 0 %>
		          center: new google.maps.LatLng(<%= @arrRooms[0].latitude %>, <%= @arrRooms[0].longitude %>),
		        <% else %>  
		        	center: new google.maps.LatLng(44.5403, -78.5463),
		        <% end %>  
	          zoom: 10,
	          mapTypeId: google.maps.MapTypeId.ROADMAP
	        }
	        var map = new google.maps.Map(mapCanvas, mapOptions);

	        <% @arrRooms.each do |room| %>	
		        var marker = new google.maps.Marker({
		        	position: new google.maps.LatLng(<%= room.latitude %>, <%= room.longitude %>),
		        	title: "GoHiSo" 
		        });

		        marker.setMap(map);
	        <% end %>
	      }
	      google.maps.event.addDomListener(window, 'load', initialize);
	    </script>
			
		</div>
	</div>

	<div id="article">
		
		<div class="row">
			
			<% room_count = 0 %>
			<% @rooms.each do |room| %>
				<% room_count += 1 %>
				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading preview">
							<%= image_tag room.photos[0].image.url(:medium) if room.photos.length > 0 %>
						</div>
						<div class="panel-body">
							<%= image_tag avatar_url(room.user), class: "img-circle avatar-small" %>&nbsp;
							<%= link_to room.listing_name, room %>
						</div>
					</div>
				</div>
				<% if room_count % 2 == 0 %>
					<div class="clearfix" style="max-height: 276px"></div>

				<% end %>
				
			<% end %>

		</div>

	</div>
	
</div>

<script>
	$(function() {
		$("#start_date").datepicker({
			dateFormat: 'dd-mm-yy',
			minDate: 0,
			maxDate: '3m',
			onSelect: function(selected) {
				$('#end_date').datepicker("option", "minDate", selected);
				$('#end_date').attr('disabled', false);
			}
		});

		$("#end_date").datepicker({
			dateFormat: 'dd-mm-yy',
			minDate: 0,
			maxDate: '3m',
			onSelect: function(selected) {
				$('#start_date').datepicker("option", "maxDate", selected);
			}
		});
	})
</script>

<script>
	
	$(function(){ // document ready
 
	  if (!!$('.sticky').offset()) { // make sure ".sticky" element exists
	 
	    var stickyTop = $('.sticky').offset().top; // returns number 
	 
	    $(window).scroll(function(){ // scroll event
	 
	      var windowTop = $(window).scrollTop(); // returns number 
	 
	      if (stickyTop < windowTop){
	        $('.sticky').css({ position: 'fixed', top: 0 });
	      }
	      else {
	        $('.sticky').css('position','static');
	      }
	 
	    });
	 
	  }
	 
	});

</script>